
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>sim_circuit_playground</title><meta name="generator" content="MATLAB 9.8"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2022-12-01"><meta name="DC.source" content="sim_circuit_playground.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; }

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }
span.typesection { color:#A0522D }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><pre class="codeinput">v1l = <span class="string">'10'</span>;
v2l = <span class="string">'120'</span>;
tdl = <span class="string">'0.5'</span>;
tfl = <span class="string">'0.15'</span>;
trl = <span class="string">'0.25'</span>;
pwl = <span class="string">'0.4'</span>;
perl = <span class="string">'1'</span>;

v1r = <span class="string">'4'</span>;
v2r = <span class="string">'25'</span>;
tdr = <span class="string">'0.5'</span>;
tfr = <span class="string">'0.15'</span>;
trr = <span class="string">'0.25'</span>;
pwr = <span class="string">'0.4'</span>;
perr = <span class="string">'1'</span>;

C_sas = <span class="string">'0.08'</span>;
L_sas = <span class="string">'0.000062'</span>;
R_sas = <span class="string">'0.003'</span>;
L_sat = <span class="string">'0.0017'</span>;
C_sat = <span class="string">'1.6'</span>;
R_sat = <span class="string">'0.05'</span>;
R_sar = <span class="string">'0.5'</span>;
R_scp = <span class="string">'0.52'</span>;

R_brain = <span class="string">'0.908336'</span>;
R_liver = <span class="string">'0.681252'</span>;
R_spleen = <span class="string">'4.54168'</span>;
R_kidney = <span class="string">'0.592393'</span>;

R_svn = <span class="string">'0.075'</span>;
C_pas = <span class="string">'0.18'</span>;
R_pas = <span class="string">'0.002'</span>;
L_pas = <span class="string">'0.000052'</span>;
C_pat = <span class="string">'3.8'</span>;
R_pat = <span class="string">'0.01'</span>;
L_pat = <span class="string">'0.0017'</span>;
R_par = <span class="string">'0.05'</span>;
R_pcp = <span class="string">'0.25'</span>;
C_pvn = <span class="string">'20.5'</span>;
R_pvn = <span class="string">'0.006'</span>;
duration = <span class="string">'60'</span>;

[time, Q_right_heart, Q_left_heart, V_left_heart,<span class="keyword">...</span>
            V_right_heart, P_right_heart, P_left_heart, Q_sas, Q_sat,<span class="keyword">...</span>
            Q_sar, Q_scp, V_sas, V_sat, V_sar, V_scp, P_sas, P_sat,<span class="keyword">...</span>
            P_sar, P_scp, Q_svn, V_svn, P_svn, Q_organs, V_organs,<span class="keyword">...</span>
            P_organs, Q_brain, Q_kidney, Q_spleen, Q_liver, V_brain,<span class="keyword">...</span>
            V_kidney, V_spleen, V_liver, Q_pas, Q_pat, Q_par, Q_pcp,<span class="keyword">...</span>
            V_pas, V_pat, V_par, V_pcp, P_pas, P_pat, P_par, P_pcp,<span class="keyword">...</span>
            Q_pvn, V_pvn, P_pvn] = simulinkSimulator(<span class="keyword">...</span>
                            v1l, v2l, tdl, tfl, trl, pwl, perl, v1r, v2r, tdr,<span class="keyword">...</span>
                            tfr, trr, pwr, perr, C_sas, L_sas, R_sas, L_sat,<span class="keyword">...</span>
                            C_sat, R_sat, R_sar, R_scp, R_brain, R_liver,<span class="keyword">...</span>
                            R_spleen, R_kidney, R_svn, C_pas,<span class="keyword">...</span>
                            R_pas, L_pas, C_pat, R_pat, L_pat, R_par, R_pcp,<span class="keyword">...</span>
                            C_pvn, R_pvn, duration);


save(<span class="string">'time.mat'</span>,<span class="string">'time'</span>,<span class="string">'-mat'</span>)
save(<span class="string">'Q_left_heart.mat'</span>,<span class="string">'Q_left_heart'</span>,<span class="string">'-mat'</span>)
save(<span class="string">'Q_right_heart.mat'</span>,<span class="string">'Q_right_heart'</span>,<span class="string">'-mat'</span>)
save(<span class="string">'Q_sas.mat'</span>,<span class="string">'Q_sas'</span>,<span class="string">'-mat'</span>)
save(<span class="string">'Q_sat.mat'</span>,<span class="string">'Q_sat'</span>,<span class="string">'-mat'</span>)
save(<span class="string">'Q_sar.mat'</span>,<span class="string">'Q_sar'</span>,<span class="string">'-mat'</span>)
save(<span class="string">'Q_scp.mat'</span>,<span class="string">'Q_scp'</span>,<span class="string">'-mat'</span>)
save(<span class="string">'Q_svn.mat'</span>,<span class="string">'Q_svn'</span>,<span class="string">'-mat'</span>)
save(<span class="string">'Q_organs.mat'</span>,<span class="string">'Q_organs'</span>,<span class="string">'-mat'</span>)
save(<span class="string">'Q_brain.mat'</span>,<span class="string">'Q_brain'</span>,<span class="string">'-mat'</span>)
save(<span class="string">'Q_kidney.mat'</span>,<span class="string">'Q_kidney'</span>,<span class="string">'-mat'</span>)
save(<span class="string">'Q_liver.mat'</span>,<span class="string">'Q_liver'</span>,<span class="string">'-mat'</span>)
save(<span class="string">'Q_spleen.mat'</span>,<span class="string">'Q_spleen'</span>,<span class="string">'-mat'</span>)
save(<span class="string">'Q_pas.mat'</span>,<span class="string">'Q_pas'</span>,<span class="string">'-mat'</span>)
save(<span class="string">'Q_pat.mat'</span>,<span class="string">'Q_pat'</span>,<span class="string">'-mat'</span>)
save(<span class="string">'Q_par.mat'</span>,<span class="string">'Q_par'</span>,<span class="string">'-mat'</span>)
save(<span class="string">'Q_pcp.mat'</span>,<span class="string">'Q_pcp'</span>,<span class="string">'-mat'</span>)
save(<span class="string">'Q_pvn.mat'</span>,<span class="string">'Q_pvn'</span>,<span class="string">'-mat'</span>)


plot_signals(time, Q_right_heart, Q_left_heart, V_left_heart,<span class="keyword">...</span>
            V_right_heart, P_right_heart, P_left_heart, Q_sas, Q_sat,<span class="keyword">...</span>
            Q_sar, Q_scp, V_sas, V_sat, V_sar, V_scp, P_sas, P_sat,<span class="keyword">...</span>
            P_sar, P_scp, Q_svn, V_svn, P_svn, Q_organs, V_organs,<span class="keyword">...</span>
            P_organs, Q_brain, Q_kidney, Q_spleen, Q_liver, V_brain,<span class="keyword">...</span>
            V_kidney, V_spleen, V_liver, Q_pas, Q_pat, Q_par, Q_pcp,<span class="keyword">...</span>
            V_pas, V_pat, V_par, V_pcp, P_pas, P_pat, P_par, P_pcp,<span class="keyword">...</span>
            Q_pvn, V_pvn, P_pvn);

true_brain = 750; <span class="comment">%mL/min</span>
true_lungs = 600; <span class="comment">%mL/min</span>
true_heart = 6000; <span class="comment">%mL/min</span>
true_kidneys = 1100; <span class="comment">%mL/min</span>
true_liver = 1000; <span class="comment">%mL/min</span>
true_spleen = 150; <span class="comment">%mL/min</span>

fprintf(<span class="string">"Cardiac Output: %0.3f mL\nKidney Volume: %0.3f mL\nSpleen Volume: %0.3f mL\nLiver Volume: %0.3f mL\nBrain Volume: %0.3f mL\n\n"</span>,<span class="keyword">...</span>
    [(V_left_heart(length(V_left_heart)) + V_right_heart(length(V_right_heart))), V_kidney, V_spleen, V_liver, V_brain]);

calc_heart = V_left_heart(length(V_left_heart)) + V_right_heart(length(V_right_heart));
calc_lung = calc_heart * 0.1;

acc_heart = 100 - abs((true_heart - calc_heart) / true_heart) * 100;
acc_lungs = 100 - abs((true_lungs - calc_lung) / true_lungs) * 100;
acc_brain = 100 - abs((true_brain - V_brain) / true_brain) * 100;
acc_kidney = 100 - abs((true_kidneys - V_kidney) / true_kidneys) * 100;
acc_liver = 100 - abs((true_liver - V_liver) / true_liver) * 100;
acc_spleen = 100 - abs((true_spleen - V_spleen) / true_spleen) * 100;

accs = [acc_heart acc_lungs acc_brain acc_kidney acc_liver acc_spleen];

avg_acc = mean(accs);

fprintf(<span class="string">"Cardiac Output Accuracy: %0.3f%%\nLung Accuracy: %0.3f%%\nBrain Accuracy: %0.3f%%\nKidney Accuracy: %0.3f%%\nLiver Accuracy: %0.3f%%\nSpleen Accuracy: %0.3f%%\n\n"</span>,<span class="keyword">...</span>
    accs);

fprintf(<span class="string">"Average Accuracy: %0.3f%%\n\n"</span>,avg_acc);


<span class="keyword">function</span> [time, Q_right_heart, Q_left_heart, V_left_heart,<span class="keyword">...</span>
            V_right_heart, P_right_heart, P_left_heart, Q_sas, Q_sat,<span class="keyword">...</span>
            Q_sar, Q_scp, V_sas, V_sat, V_sar, V_scp, P_sas, P_sat,<span class="keyword">...</span>
            P_sar, P_scp, Q_svn, V_svn, P_svn, Q_organs, V_organs,<span class="keyword">...</span>
            P_organs, Q_brain, Q_kidney, Q_spleen, Q_liver, V_brain,<span class="keyword">...</span>
            V_kidney, V_spleen, V_liver, Q_pas, Q_pat, Q_par, Q_pcp,<span class="keyword">...</span>
            V_pas, V_pat, V_par, V_pcp, P_pas, P_pat, P_par, P_pcp,<span class="keyword">...</span>
            Q_pvn, V_pvn, P_pvn] = simulinkSimulator(v1l,<span class="keyword">...</span>
                            v2l, tdl, tfl, trl, pwl, perl, v1r, v2r, tdr,<span class="keyword">...</span>
                            tfr, trr, pwr, perr, C_sas, L_sas, R_sas, L_sat,<span class="keyword">...</span>
                            C_sat, R_sat, R_sar, R_scp, R_brain, R_liver,<span class="keyword">...</span>
                            R_spleen, R_kidney, R_svn, C_pas,<span class="keyword">...</span>
                            R_pas, L_pas, C_pat, R_pat, L_pat, R_par, R_pcp,<span class="keyword">...</span>
                            C_pvn, R_pvn, duration)
<span class="comment">% ----------------------------------------------------------</span>
<span class="comment">% Function Description:</span>
<span class="comment">% This function runs the simulation and plots the results. Takes in initial</span>
<span class="comment">% conditions as input defined below.</span>
<span class="comment">% ----------------------------------------------------------</span>

<span class="comment">% ----------------------------------------------------------</span>
<span class="comment">% Input Variables:</span>
<span class="comment">% *** Note - all inputs are string data types ***</span>

<span class="comment">%   Heart Values</span>
<span class="comment">%   Heart Pump Prefixes:</span>
<span class="comment">%       - v1 = scalar initial voltage 1 for heart pump</span>
<span class="comment">%       - v2 = scalar initial voltage 2 for heart pump</span>
<span class="comment">%       - td = pulse delay time (in seconds) for heart pump</span>
<span class="comment">%       - tr = pulse rise time (in seconds) for heart pump</span>
<span class="comment">%       - tf = pulse fall time (in seconds) for heart pump</span>
<span class="comment">%   Heart Pump Suffix of l and r denote left or right heart pump</span>

<span class="comment">%   Electronic Prefixes</span>
<span class="comment">%       - C = scalar capacitance value of compartment of interest modeling</span>
<span class="comment">%           the compliance of vessel</span>
<span class="comment">%       - L = scalar inductance value of compartment of interest modeling</span>
<span class="comment">%           the inertance of the vessel</span>
<span class="comment">%       - R = scalar resistance value of compartment of interest modeling</span>
<span class="comment">%           the resistance of blood flow</span>

<span class="comment">%   Electronic Suffixes</span>
<span class="comment">%       - sas = systemic aortic sinus</span>
<span class="comment">%       - sat = systemic arteries</span>
<span class="comment">%       - sar = systemic arterioles</span>
<span class="comment">%       - scp = systemic capillaries</span>
<span class="comment">%       - svn = systemic veins</span>
<span class="comment">%       - pas = pulmonary aortic sinus</span>
<span class="comment">%       - pat = pulmonary arteries</span>
<span class="comment">%       - par = pulmonary arterioles</span>
<span class="comment">%       - pcp = pulmonary capillaries</span>
<span class="comment">%       - pvn = pulmonary veins</span>
<span class="comment">% ----------------------------------------------------------</span>

<span class="comment">% ----------------------------------------------------------</span>
<span class="comment">% Output Variables:</span>


<span class="comment">% ----------------------------------------------------------</span>

<span class="comment">% ----------------------------------------------------------</span>
<span class="comment">% PARAMETERS FOR MODEL</span>
<span class="comment">% ----------------------------------------------------------</span>

<span class="comment">% capacitor_param = c (in Farad)</span>
<span class="comment">% inductor_param = l (in Henry)</span>
<span class="comment">% resistor_param = R (in Ohms)</span>

<span class="comment">% heart_params = ['V1', 'V2', 'TD', 'TR', 'TF', 'pW', 'PER'];</span>
<span class="comment">% V1 = initial voltage 1 (in Volts)</span>
<span class="comment">% V2 = initial voltage 2 (in Volts)</span>
<span class="comment">% TD = pulse delay time (in seconds)</span>
<span class="comment">% TR = pulse rise time (in seconds)</span>
<span class="comment">% TF = pulse fall time (in seconds)</span>
<span class="comment">% pW = pulse width (in seconds)</span>
<span class="comment">% PER = pulse period (in seconds)</span>

<span class="comment">% Sets parameters of Simulink model</span>
set_param(<span class="string">'CirculationCircuitv2021_v3/R_scp'</span>, <span class="string">'R'</span>, R_scp);
set_param(<span class="string">'CirculationCircuitv2021_v3/R_sas'</span>, <span class="string">'R'</span>, R_sas);
set_param(<span class="string">'CirculationCircuitv2021_v3/R_sat'</span>, <span class="string">'R'</span>, R_sat);
set_param(<span class="string">'CirculationCircuitv2021_v3/R_sar'</span>, <span class="string">'R'</span>, R_sar);
set_param(<span class="string">'CirculationCircuitv2021_v3/R_brain'</span>, <span class="string">'R'</span>, R_brain);
set_param(<span class="string">'CirculationCircuitv2021_v3/R_kidney'</span>, <span class="string">'R'</span>, R_kidney);
set_param(<span class="string">'CirculationCircuitv2021_v3/R_spleen'</span>, <span class="string">'R'</span>, R_spleen);
set_param(<span class="string">'CirculationCircuitv2021_v3/R_liver'</span>, <span class="string">'R'</span>, R_liver);
set_param(<span class="string">'CirculationCircuitv2021_v3/R_svn'</span>, <span class="string">'R'</span>, R_svn);
set_param(<span class="string">'CirculationCircuitv2021_v3/R_pas'</span>, <span class="string">'R'</span>, R_pas);
set_param(<span class="string">'CirculationCircuitv2021_v3/R_pat'</span>, <span class="string">'R'</span>, R_pat);
set_param(<span class="string">'CirculationCircuitv2021_v3/R_par'</span>, <span class="string">'R'</span>, R_par);
set_param(<span class="string">'CirculationCircuitv2021_v3/R_pcp'</span>, <span class="string">'R'</span>, R_pcp);
set_param(<span class="string">'CirculationCircuitv2021_v3/R_pvn'</span>, <span class="string">'R'</span>, R_pvn);

set_param(<span class="string">'CirculationCircuitv2021_v3/C_sas'</span>, <span class="string">'c'</span>, C_sas);
set_param(<span class="string">'CirculationCircuitv2021_v3/C_sat'</span>, <span class="string">'c'</span>, C_sat);
set_param(<span class="string">'CirculationCircuitv2021_v3/C_sas'</span>, <span class="string">'c'</span>, C_sas);
set_param(<span class="string">'CirculationCircuitv2021_v3/C_pas'</span>, <span class="string">'c'</span>, C_pas);
set_param(<span class="string">'CirculationCircuitv2021_v3/C_pat'</span>, <span class="string">'c'</span>, C_pat);
set_param(<span class="string">'CirculationCircuitv2021_v3/C_pvn'</span>, <span class="string">'c'</span>, C_pvn);

set_param(<span class="string">'CirculationCircuitv2021_v3/L_sas'</span>, <span class="string">'l'</span>, L_sas);
set_param(<span class="string">'CirculationCircuitv2021_v3/L_pas'</span>, <span class="string">'l'</span>, L_pas);
set_param(<span class="string">'CirculationCircuitv2021_v3/L_sat'</span>, <span class="string">'l'</span>, L_sat);
set_param(<span class="string">'CirculationCircuitv2021_v3/L_pat'</span>, <span class="string">'l'</span>, L_pat);

set_param(<span class="string">'CirculationCircuitv2021_v3/Heart_L'</span>, <span class="string">'V1'</span>, v1l);
set_param(<span class="string">'CirculationCircuitv2021_v3/Heart_L'</span>, <span class="string">'V2'</span>, v2l);
set_param(<span class="string">'CirculationCircuitv2021_v3/Heart_L'</span>, <span class="string">'TD'</span>, tdl);
set_param(<span class="string">'CirculationCircuitv2021_v3/Heart_L'</span>, <span class="string">'TF'</span>, tfl);
set_param(<span class="string">'CirculationCircuitv2021_v3/Heart_L'</span>, <span class="string">'TR'</span>, trl);
set_param(<span class="string">'CirculationCircuitv2021_v3/Heart_L'</span>, <span class="string">'pW'</span>, pwl);
set_param(<span class="string">'CirculationCircuitv2021_v3/Heart_L'</span>, <span class="string">'PER'</span>, perl);

set_param(<span class="string">'CirculationCircuitv2021_v3/Heart_R'</span>, <span class="string">'V1'</span>, v1r);
set_param(<span class="string">'CirculationCircuitv2021_v3/Heart_R'</span>, <span class="string">'V2'</span>, v2r);
set_param(<span class="string">'CirculationCircuitv2021_v3/Heart_R'</span>, <span class="string">'TD'</span>, tdr);
set_param(<span class="string">'CirculationCircuitv2021_v3/Heart_R'</span>, <span class="string">'TF'</span>, tfr);
set_param(<span class="string">'CirculationCircuitv2021_v3/Heart_R'</span>, <span class="string">'TF'</span>, trr);
set_param(<span class="string">'CirculationCircuitv2021_v3/Heart_R'</span>, <span class="string">'pW'</span>, pwr);
set_param(<span class="string">'CirculationCircuitv2021_v3/Heart_R'</span>, <span class="string">'PER'</span>, perr);

simOut=sim(<span class="string">'CirculationCircuitv2021_v3'</span>, <span class="string">'StartTime'</span>,<span class="string">'0'</span>,<span class="string">'StopTime'</span>,duration,<span class="keyword">...</span>
            <span class="string">'FixedStep'</span>,<span class="string">'0.0001'</span>); <span class="comment">% Loads and runs model</span>

<span class="comment">% Reads in results of Simulink model</span>
Q_right_heart = simOut.Q_right_heart.signals.values;
time = simOut.Q_right_heart.time;
Q_left_heart = simOut.Q_left_heart.signals.values;
V_left_heart = simOut.V_left_heart.signals.values;
V_right_heart = simOut.V_right_heart.signals.values;
P_right_heart = simOut.P_right_heart.signals.values;
P_left_heart = simOut.P_left_heart.signals.values;

Q_sas = simOut.Q_sas.signals.values;
Q_sat = simOut.Q_sat.signals.values;
Q_sar = simOut.Q_sar.signals.values;
Q_scp = simOut.Q_scp.signals.values;
V_sas = simOut.V_sas.signals.values;
V_sat = simOut.V_sat.signals.values;
V_sar = simOut.V_sar.signals.values;
V_scp = simOut.V_scp.signals.values;
P_sas = simOut.P_sas.signals.values;
P_sat = simOut.P_sat.signals.values;
P_sar = simOut.P_sar.signals.values;
P_scp = simOut.P_scp.signals.values;

Q_svn = simOut.Q_svn.signals.values;
V_svn = simOut.V_svn.signals.values;
P_svn = simOut.P_svn.signals.values;

P_organs = simOut.P_organs.signals.values;

Req = 1/((1/str2double(R_liver)) + (1/str2double(R_spleen)) + <span class="keyword">...</span>
        (1/str2double(R_kidney)) + (1/str2double(R_brain)));

<span class="comment">% V_brain = (V_left_heart + V_right_heart).*0.15;</span>
<span class="comment">% V_kidney = (V_left_heart + V_right_heart).*0.25;</span>
<span class="comment">% V_spleen = (V_left_heart + V_right_heart).*0.03;</span>
<span class="comment">% V_liver = (V_left_heart + V_right_heart).*0.20;</span>
<span class="comment">% V_organs = (V_left_heart + V_right_heart);</span>

Q_brain = P_organs ./ str2double(R_brain);
Q_kidney = P_organs ./ str2double(R_kidney);
Q_spleen = P_organs ./ str2double(R_spleen);
Q_liver = P_organs ./ str2double(R_liver);
Q_organs = P_organs ./ Req;

V_brain = mean(Q_brain)*str2double(duration);
V_kidney = mean(Q_kidney)*str2double(duration);
V_spleen = mean(Q_spleen)*str2double(duration);
V_liver = mean(Q_liver)*str2double(duration);
V_organs = mean(Q_organs)*str2double(duration);

Q_pas = simOut.Q_pas.signals.values;
Q_pat = simOut.Q_pat.signals.values;
Q_par = simOut.Q_par.signals.values;
Q_pcp = simOut.Q_pcp.signals.values;
V_pas = simOut.V_pas.signals.values;
V_pat = simOut.V_pat.signals.values;
V_par = simOut.V_par.signals.values;
V_pcp = simOut.V_pcp.signals.values;
P_pas = simOut.P_pas.signals.values;
P_pat = simOut.P_pat.signals.values;
P_par = simOut.P_par.signals.values;
P_pcp = simOut.P_pcp.signals.values;

Q_pvn = simOut.Q_pvn.signals.values;
V_pvn = simOut.V_pvn.signals.values;
P_pvn = simOut.P_pvn.signals.values;

<span class="keyword">end</span>

<span class="keyword">function</span> plot_signals(time, Q_right_heart, Q_left_heart, V_left_heart,<span class="keyword">...</span>
            V_right_heart, P_right_heart, P_left_heart, Q_sas, Q_sat,<span class="keyword">...</span>
            Q_sar, Q_scp, V_sas, V_sat, V_sar, V_scp, P_sas, P_sat,<span class="keyword">...</span>
            P_sar, P_scp, Q_svn, V_svn, P_svn, Q_organs, V_organs,<span class="keyword">...</span>
            P_organs, Q_brain, Q_kidney, Q_spleen, Q_liver, V_brain,<span class="keyword">...</span>
            V_kidney, V_spleen, V_liver, Q_pas, Q_pat, Q_par, Q_pcp,<span class="keyword">...</span>
            V_pas, V_pat, V_par, V_pcp, P_pas, P_pat, P_par, P_pcp,<span class="keyword">...</span>
            Q_pvn, V_pvn, P_pvn)
<span class="comment">% This function plots all of the pressure, flow, and volume results from</span>
<span class="comment">% the Simulink model.</span>

<span class="comment">% ----------------------------------------------------------</span>
<span class="comment">% Heart Dynamics</span>
<span class="comment">% ----------------------------------------------------------</span>
figure
subplot(2,3,1)
plot(time,Q_right_heart);
title(<span class="string">'Q_{Right Heart}'</span>);
xlabel(<span class="string">'Time (s)'</span>);
ylabel(<span class="string">'Flow Rate (mL/s)'</span>);

subplot(2,3,4)
plot(time,Q_left_heart);
title(<span class="string">'Q_{Left Heart}'</span>);
xlabel(<span class="string">'Time (s)'</span>);
ylabel(<span class="string">'Flow Rate (mL/s)'</span>);

subplot(2,3,2)
plot(time,V_right_heart);
title(<span class="string">'V_{Right Heart}'</span>);
xlabel(<span class="string">'Time (s)'</span>);
ylabel(<span class="string">'Blood Volume (mL)'</span>);

subplot(2,3,5)
plot(time,V_left_heart);
title(<span class="string">'V_{Left Heart}'</span>);
xlabel(<span class="string">'Time (s)'</span>);
ylabel(<span class="string">'Blood Volume (mL)'</span>);

subplot(2,3,6)
plot(time,P_left_heart);
title(<span class="string">'P_{Left Heart}'</span>);
xlabel(<span class="string">'Time (s)'</span>);
ylabel(<span class="string">'Blood Pressure (mmHg)'</span>);

subplot(2,3,3)
plot(time,P_right_heart);
title(<span class="string">'P_{Right Heart}'</span>);
xlabel(<span class="string">'Time (s)'</span>);
ylabel(<span class="string">'Blood Pressure (mmHg)'</span>);

sgtitle(<span class="string">'Heart Blood Flow Dynamics'</span>);
<span class="comment">% set(gcf, 'Units', 'Normalized', 'OuterPosition', [0 0 1 1]);</span>
saveas(gcf, <span class="string">'Heart Blood Flow Dynamics.png'</span>);


<span class="comment">% ----------------------------------------------------------</span>
<span class="comment">% Systemic Arterial Loop Dynamics</span>
<span class="comment">% ----------------------------------------------------------</span>
figure
subplot(4,3,1)
plot(time, Q_sas);
title(<span class="string">'Q_{sas}'</span>);
xlabel(<span class="string">'Time (s)'</span>);
ylabel(<span class="string">'Flow Rate (mL/s)'</span>);

subplot(4,3,4)
plot(time, Q_sat);
title(<span class="string">'Q_{sat}'</span>);
xlabel(<span class="string">'Time (s)'</span>);
ylabel(<span class="string">'Flow Rate (mL/s)'</span>);

subplot(4,3,7)
plot(time, Q_sar);
title(<span class="string">'Q_{sar}'</span>);
xlabel(<span class="string">'Time (s)'</span>);
ylabel(<span class="string">'Flow Rate (mL/s)'</span>);

subplot(4,3,10)
plot(time, Q_scp);
title(<span class="string">'Q_{scp}'</span>);
xlabel(<span class="string">'Time (s)'</span>);
ylabel(<span class="string">'Flow Blood VolumeRate (mL/s)'</span>);

subplot(4,3,2)
plot(time, V_sas);
title(<span class="string">'V_{sas}'</span>);
xlabel(<span class="string">'Time (s)'</span>);
ylabel(<span class="string">'Blood Volume (mL)'</span>);

subplot(4,3,5)
plot(time, V_sat);
title(<span class="string">'V_{sat}'</span>);
xlabel(<span class="string">'Time (s)'</span>);
ylabel(<span class="string">'Blood Volume (mL)'</span>);

subplot(4,3,8)
plot(time, V_sar);
title(<span class="string">'V_{sar}'</span>);
xlabel(<span class="string">'Time (s)'</span>);
ylabel(<span class="string">'Blood Volume (mL)'</span>);

subplot(4,3,11)
plot(time, V_scp);
title(<span class="string">'V_{scp}'</span>);
xlabel(<span class="string">'Time (s)'</span>);
ylabel(<span class="string">'Blood Volume (mL)'</span>);

subplot(4,3,3)
plot(time,P_sas);
title(<span class="string">'P_{sas}'</span>);
xlabel(<span class="string">'Time (s)'</span>);
ylabel(<span class="string">'Blood Pressure (mmHg)'</span>);

subplot(4,3,6)
plot(time,P_sat);
title(<span class="string">'P_{sat}'</span>);
xlabel(<span class="string">'Time (s)'</span>);
ylabel(<span class="string">'Blood Pressure (mmHg)'</span>);

subplot(4,3,9)
plot(time,P_sar);
title(<span class="string">'P_{sar}'</span>);
xlabel(<span class="string">'Time (s)'</span>);
ylabel(<span class="string">'Blood Pressure (mmHg)'</span>);

subplot(4,3,12)
plot(time,P_scp);
title(<span class="string">'P_{scp}'</span>);
xlabel(<span class="string">'Time (s)'</span>);
ylabel(<span class="string">'Blood Pressure (mmHg)'</span>);

sgtitle(<span class="string">'Systemic Circuit Arterial Blood Flow Dynamics'</span>);
<span class="comment">% set(gcf, 'Units', 'Normalized', 'OuterPosition', [0 0 1 1]);</span>

saveas(gcf, <span class="string">'Systemic Circuit Arterial Blood Flow Dynamics.png'</span>);

<span class="comment">% ----------------------------------------------------------</span>
<span class="comment">% Systemic Venous Loop Dynamics</span>
<span class="comment">% ----------------------------------------------------------</span>

figure
subplot(3,1,1)
plot(time, Q_svn);
title(<span class="string">'Q_{svn}'</span>);
xlabel(<span class="string">'Time (s)'</span>);
ylabel(<span class="string">'Flow Rate (mL/s)'</span>);

subplot(3,1,2)
plot(time, V_svn);
title(<span class="string">'V_{svn}'</span>);
xlabel(<span class="string">'Time (s)'</span>);
ylabel(<span class="string">'Blood Volume (mL)'</span>);

subplot(3,1,3)
plot(time, P_svn);
title(<span class="string">'P_{svn}'</span>);
xlabel(<span class="string">'Time (s)'</span>);
ylabel(<span class="string">'Blood Pressure (mmHg)'</span>);

sgtitle(<span class="string">"Systemic Circuit Venous Blood Flow Dynamics"</span>);
<span class="comment">% set(gcf, 'Units', 'Normalized', 'OuterPosition', [0 0 1 1]);</span>
saveas(gcf, <span class="string">"Systemic Circuit Venous Blood Flow Dynamics.png"</span>);

<span class="comment">% ----------------------------------------------------------</span>
<span class="comment">% Organ Dynamics</span>
<span class="comment">% ----------------------------------------------------------</span>

figure
subplot(2,1,1)
plot(time,Q_organs);
title(<span class="string">'Q_o'</span>);
xlabel(<span class="string">'Time (s)'</span>);
ylabel(<span class="string">'Flow Rate (mL/s)'</span>);

subplot(2,1,2)
plot(time, P_organs);
title(<span class="string">'P_{o}'</span>);
xlabel(<span class="string">'Time (s)'</span>);
ylabel(<span class="string">'Blood Pressure (mmHg)'</span>);

sgtitle(<span class="string">"Total Organ Blood Flow Dynamics"</span>);
<span class="comment">% set(gcf, 'Units', 'Normalized', 'OuterPosition', [0 0 1 1]);</span>
saveas(gcf, <span class="string">"Total Organ Blood Flow Dynamics.png"</span>);

figure
subplot(2,2,1)
plot(time, Q_brain);
title(<span class="string">'Q_{brain}'</span>);
xlabel(<span class="string">'Time (s)'</span>);
ylabel(<span class="string">'Flow Rate (mL/s)'</span>);

subplot(2,2,2)
plot(time, Q_kidney);
title(<span class="string">'Q_{kidney}'</span>);
xlabel(<span class="string">'Time (s)'</span>);
ylabel(<span class="string">'Flow Rate (mL/s)'</span>);

subplot(2,2,3)
plot(time, Q_liver);
title(<span class="string">'Q_{liver}'</span>);
xlabel(<span class="string">'Time (s)'</span>);
ylabel(<span class="string">'Flow Rate (mL/s)'</span>);

subplot(2,2,4)
plot(time, Q_spleen);
title(<span class="string">'Q_{slpeen}'</span>);
xlabel(<span class="string">'Time (s)'</span>);
ylabel(<span class="string">'Flow Rate (mL/s)'</span>);

sgtitle(<span class="string">"Specific Organ Blood Flow Dynamics"</span>);
<span class="comment">% set(gcf, 'Units', 'Normalized', 'OuterPosition', [0 0 1 1]);</span>
saveas(gcf, <span class="string">"Specific Organ Blood Flow Dynamics.png"</span>);

<span class="comment">% ----------------------------------------------------------</span>
<span class="comment">% Pulmonary Circuit Arterial Dynamics</span>
<span class="comment">% ----------------------------------------------------------</span>

figure
subplot(4,3,1)
plot(time, Q_pas);
title(<span class="string">'Q_{pas}'</span>);
xlabel(<span class="string">'Time (s)'</span>);
ylabel(<span class="string">'Flow Rate (mL/s)'</span>);

subplot(4,3,2)
plot(time, V_pas);
title(<span class="string">'V_{pas}'</span>);
xlabel(<span class="string">'Time (s)'</span>);
ylabel(<span class="string">'Blood Volume (mL)'</span>);

subplot(4,3,3)
plot(time, P_pas);
title(<span class="string">'P_{pas}'</span>);
xlabel(<span class="string">'Time (s)'</span>);
ylabel(<span class="string">'Blood Pressure (mmHg)'</span>);

subplot(4,3,4)
plot(time, Q_pat);
title(<span class="string">'Q_{pat}'</span>);
xlabel(<span class="string">'Time (s)'</span>);
ylabel(<span class="string">'Flow Rate (mL/s)'</span>);

subplot(4,3,5)
plot(time, V_pat);
title(<span class="string">'V_{pat}'</span>);
xlabel(<span class="string">'Time (s)'</span>);
ylabel(<span class="string">'Blood Volume (mL)'</span>);

subplot(4,3,6)
plot(time, P_pat);
title(<span class="string">'P_{pat}'</span>);
xlabel(<span class="string">'Time (s)'</span>);
ylabel(<span class="string">'Blood Pressure (mmHg)'</span>);

subplot(4,3,7)
plot(time, Q_par);
title(<span class="string">'Q_{par}'</span>);
xlabel(<span class="string">'Time (s)'</span>);
ylabel(<span class="string">'Flow Rate (mL/s)'</span>);

subplot(4,3,8)
plot(time, V_par);
title(<span class="string">'V_{par}'</span>);
xlabel(<span class="string">'Time (s)'</span>);
ylabel(<span class="string">'Blood Volume (mL)'</span>);

subplot(4,3,9)
plot(time, P_par);
title(<span class="string">'P_{par}'</span>);
xlabel(<span class="string">'Time (s)'</span>);
ylabel(<span class="string">'Blood Pressure (mmHg)'</span>);

subplot(4,3,10)
plot(time, Q_pcp);
title(<span class="string">'Q_{pcp}'</span>);
xlabel(<span class="string">'Time (s)'</span>);
ylabel(<span class="string">'Flow Rate (mL/s)'</span>);

subplot(4,3,11)
plot(time, V_pcp);
title(<span class="string">'V_{pcp}'</span>);
xlabel(<span class="string">'Time (s)'</span>);
ylabel(<span class="string">'Blood Volume (mL)'</span>);

subplot(4,3,12)
plot(time, P_pcp);
title(<span class="string">'P_{pcp}'</span>);
xlabel(<span class="string">'Time (s)'</span>);
ylabel(<span class="string">'Blood Pressure (mmHg)'</span>);

sgtitle(<span class="string">'Pulmonary Circuit Arterial Blood Flow Dynamics'</span>);
<span class="comment">% set(gcf, 'Units', 'Normalized', 'OuterPosition', [0 0 1 1]);</span>
saveas(gcf, <span class="string">'Pulmonary Circuit Arterial Blood Flow Dynamics.png'</span>);

<span class="comment">% ----------------------------------------------------------</span>
<span class="comment">% Pulmonary Circuit Venous Dynamics</span>
<span class="comment">% ----------------------------------------------------------</span>

figure
subplot(3,1,1)
plot(time, Q_pvn);
title(<span class="string">'Q_{pvn}'</span>);
xlabel(<span class="string">'Time (s)'</span>);
ylabel(<span class="string">'Flow Rate (mL/s)'</span>);

subplot(3,1,2)
plot(time, V_pvn);
title(<span class="string">'V_{pvn}'</span>);
xlabel(<span class="string">'Time (s)'</span>);
ylabel(<span class="string">'Blood Volume (mL)'</span>);

subplot(3,1,3)
plot(time, P_pvn);
title(<span class="string">'P_{pvn}'</span>);
xlabel(<span class="string">'Time (s)'</span>);
ylabel(<span class="string">'Blood Pressure (mmHg)'</span>);

sgtitle(<span class="string">"Pulmonary Circuit Venous Blood Flow Dynamics"</span>);
<span class="comment">% set(gcf, 'Units', 'Normalized', 'OuterPosition', [0 0 1 1]);</span>
saveas(gcf, <span class="string">"Pulmonary Circuit Venous Blood Flow Dynamics.png"</span>);

<span class="keyword">end</span>
</pre><pre class="codeoutput">Cardiac Output: 6205.810 mL
Kidney Volume: 1144.595 mL
Spleen Volume: 149.295 mL
Liver Volume: 995.300 mL
Brain Volume: 746.475 mL

Cardiac Output Accuracy: 96.570%
Lung Accuracy: 96.570%
Brain Accuracy: 99.530%
Kidney Accuracy: 95.946%
Liver Accuracy: 99.530%
Spleen Accuracy: 99.530%

Average Accuracy: 97.946%

</pre><img vspace="5" hspace="5" src="sim_circuit_playground_01.png" alt=""> <img vspace="5" hspace="5" src="sim_circuit_playground_02.png" alt=""> <img vspace="5" hspace="5" src="sim_circuit_playground_03.png" alt=""> <img vspace="5" hspace="5" src="sim_circuit_playground_04.png" alt=""> <img vspace="5" hspace="5" src="sim_circuit_playground_05.png" alt=""> <img vspace="5" hspace="5" src="sim_circuit_playground_06.png" alt=""> <img vspace="5" hspace="5" src="sim_circuit_playground_07.png" alt=""> <p class="footer"><br><a href="https://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2020a</a><br></p></div><!--
##### SOURCE BEGIN #####
v1l = '10';
v2l = '120';
tdl = '0.5';
tfl = '0.15';
trl = '0.25';
pwl = '0.4';
perl = '1';

v1r = '4';
v2r = '25';
tdr = '0.5';
tfr = '0.15';
trr = '0.25';
pwr = '0.4';
perr = '1';

C_sas = '0.08';
L_sas = '0.000062';
R_sas = '0.003';
L_sat = '0.0017';
C_sat = '1.6';
R_sat = '0.05';
R_sar = '0.5';
R_scp = '0.52';

R_brain = '0.908336';
R_liver = '0.681252';
R_spleen = '4.54168';
R_kidney = '0.592393';

R_svn = '0.075';
C_pas = '0.18';
R_pas = '0.002';
L_pas = '0.000052';
C_pat = '3.8';
R_pat = '0.01';
L_pat = '0.0017';
R_par = '0.05';
R_pcp = '0.25';
C_pvn = '20.5';
R_pvn = '0.006';
duration = '60';

[time, Q_right_heart, Q_left_heart, V_left_heart,...
            V_right_heart, P_right_heart, P_left_heart, Q_sas, Q_sat,...
            Q_sar, Q_scp, V_sas, V_sat, V_sar, V_scp, P_sas, P_sat,...
            P_sar, P_scp, Q_svn, V_svn, P_svn, Q_organs, V_organs,...
            P_organs, Q_brain, Q_kidney, Q_spleen, Q_liver, V_brain,...
            V_kidney, V_spleen, V_liver, Q_pas, Q_pat, Q_par, Q_pcp,...
            V_pas, V_pat, V_par, V_pcp, P_pas, P_pat, P_par, P_pcp,...
            Q_pvn, V_pvn, P_pvn] = simulinkSimulator(...
                            v1l, v2l, tdl, tfl, trl, pwl, perl, v1r, v2r, tdr,...
                            tfr, trr, pwr, perr, C_sas, L_sas, R_sas, L_sat,...
                            C_sat, R_sat, R_sar, R_scp, R_brain, R_liver,...
                            R_spleen, R_kidney, R_svn, C_pas,...
                            R_pas, L_pas, C_pat, R_pat, L_pat, R_par, R_pcp,...
                            C_pvn, R_pvn, duration);
                        
                        
save('time.mat','time','-mat')
save('Q_left_heart.mat','Q_left_heart','-mat')
save('Q_right_heart.mat','Q_right_heart','-mat')
save('Q_sas.mat','Q_sas','-mat')
save('Q_sat.mat','Q_sat','-mat')
save('Q_sar.mat','Q_sar','-mat')
save('Q_scp.mat','Q_scp','-mat')
save('Q_svn.mat','Q_svn','-mat')
save('Q_organs.mat','Q_organs','-mat')
save('Q_brain.mat','Q_brain','-mat')
save('Q_kidney.mat','Q_kidney','-mat')
save('Q_liver.mat','Q_liver','-mat')
save('Q_spleen.mat','Q_spleen','-mat')
save('Q_pas.mat','Q_pas','-mat')
save('Q_pat.mat','Q_pat','-mat')
save('Q_par.mat','Q_par','-mat')
save('Q_pcp.mat','Q_pcp','-mat')
save('Q_pvn.mat','Q_pvn','-mat')


plot_signals(time, Q_right_heart, Q_left_heart, V_left_heart,...
            V_right_heart, P_right_heart, P_left_heart, Q_sas, Q_sat,...
            Q_sar, Q_scp, V_sas, V_sat, V_sar, V_scp, P_sas, P_sat,...
            P_sar, P_scp, Q_svn, V_svn, P_svn, Q_organs, V_organs,...
            P_organs, Q_brain, Q_kidney, Q_spleen, Q_liver, V_brain,...
            V_kidney, V_spleen, V_liver, Q_pas, Q_pat, Q_par, Q_pcp,...
            V_pas, V_pat, V_par, V_pcp, P_pas, P_pat, P_par, P_pcp,...
            Q_pvn, V_pvn, P_pvn);
        
true_brain = 750; %mL/min
true_lungs = 600; %mL/min
true_heart = 6000; %mL/min
true_kidneys = 1100; %mL/min
true_liver = 1000; %mL/min
true_spleen = 150; %mL/min

fprintf("Cardiac Output: %0.3f mL\nKidney Volume: %0.3f mL\nSpleen Volume: %0.3f mL\nLiver Volume: %0.3f mL\nBrain Volume: %0.3f mL\n\n",...
    [(V_left_heart(length(V_left_heart)) + V_right_heart(length(V_right_heart))), V_kidney, V_spleen, V_liver, V_brain]);

calc_heart = V_left_heart(length(V_left_heart)) + V_right_heart(length(V_right_heart));
calc_lung = calc_heart * 0.1;

acc_heart = 100 - abs((true_heart - calc_heart) / true_heart) * 100;
acc_lungs = 100 - abs((true_lungs - calc_lung) / true_lungs) * 100;
acc_brain = 100 - abs((true_brain - V_brain) / true_brain) * 100;
acc_kidney = 100 - abs((true_kidneys - V_kidney) / true_kidneys) * 100;
acc_liver = 100 - abs((true_liver - V_liver) / true_liver) * 100;
acc_spleen = 100 - abs((true_spleen - V_spleen) / true_spleen) * 100;

accs = [acc_heart acc_lungs acc_brain acc_kidney acc_liver acc_spleen];

avg_acc = mean(accs);

fprintf("Cardiac Output Accuracy: %0.3f%%\nLung Accuracy: %0.3f%%\nBrain Accuracy: %0.3f%%\nKidney Accuracy: %0.3f%%\nLiver Accuracy: %0.3f%%\nSpleen Accuracy: %0.3f%%\n\n",...
    accs);

fprintf("Average Accuracy: %0.3f%%\n\n",avg_acc);


function [time, Q_right_heart, Q_left_heart, V_left_heart,...
            V_right_heart, P_right_heart, P_left_heart, Q_sas, Q_sat,...
            Q_sar, Q_scp, V_sas, V_sat, V_sar, V_scp, P_sas, P_sat,...
            P_sar, P_scp, Q_svn, V_svn, P_svn, Q_organs, V_organs,...
            P_organs, Q_brain, Q_kidney, Q_spleen, Q_liver, V_brain,...
            V_kidney, V_spleen, V_liver, Q_pas, Q_pat, Q_par, Q_pcp,...
            V_pas, V_pat, V_par, V_pcp, P_pas, P_pat, P_par, P_pcp,...
            Q_pvn, V_pvn, P_pvn] = simulinkSimulator(v1l,...
                            v2l, tdl, tfl, trl, pwl, perl, v1r, v2r, tdr,...
                            tfr, trr, pwr, perr, C_sas, L_sas, R_sas, L_sat,...
                            C_sat, R_sat, R_sar, R_scp, R_brain, R_liver,...
                            R_spleen, R_kidney, R_svn, C_pas,...
                            R_pas, L_pas, C_pat, R_pat, L_pat, R_par, R_pcp,...
                            C_pvn, R_pvn, duration)
% REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH
% Function Description:
% This function runs the simulation and plots the results. Takes in initial
% conditions as input defined below.
% REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH

% REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH
% Input Variables:
% *** Note - all inputs are string data types ***

%   Heart Values
%   Heart Pump Prefixes:
%       - v1 = scalar initial voltage 1 for heart pump
%       - v2 = scalar initial voltage 2 for heart pump
%       - td = pulse delay time (in seconds) for heart pump
%       - tr = pulse rise time (in seconds) for heart pump
%       - tf = pulse fall time (in seconds) for heart pump
%   Heart Pump Suffix of l and r denote left or right heart pump

%   Electronic Prefixes
%       - C = scalar capacitance value of compartment of interest modeling
%           the compliance of vessel
%       - L = scalar inductance value of compartment of interest modeling
%           the inertance of the vessel
%       - R = scalar resistance value of compartment of interest modeling
%           the resistance of blood flow

%   Electronic Suffixes
%       - sas = systemic aortic sinus
%       - sat = systemic arteries
%       - sar = systemic arterioles
%       - scp = systemic capillaries
%       - svn = systemic veins
%       - pas = pulmonary aortic sinus
%       - pat = pulmonary arteries
%       - par = pulmonary arterioles
%       - pcp = pulmonary capillaries
%       - pvn = pulmonary veins
% REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH

% REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH
% Output Variables:


% REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH

% REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH
% PARAMETERS FOR MODEL
% REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH

% capacitor_param = c (in Farad)
% inductor_param = l (in Henry)
% resistor_param = R (in Ohms)

% heart_params = ['V1', 'V2', 'TD', 'TR', 'TF', 'pW', 'PER'];
% V1 = initial voltage 1 (in Volts)
% V2 = initial voltage 2 (in Volts)
% TD = pulse delay time (in seconds)
% TR = pulse rise time (in seconds)
% TF = pulse fall time (in seconds)
% pW = pulse width (in seconds)
% PER = pulse period (in seconds)

% Sets parameters of Simulink model
set_param('CirculationCircuitv2021_v3/R_scp', 'R', R_scp);
set_param('CirculationCircuitv2021_v3/R_sas', 'R', R_sas);
set_param('CirculationCircuitv2021_v3/R_sat', 'R', R_sat);
set_param('CirculationCircuitv2021_v3/R_sar', 'R', R_sar);
set_param('CirculationCircuitv2021_v3/R_brain', 'R', R_brain);
set_param('CirculationCircuitv2021_v3/R_kidney', 'R', R_kidney);
set_param('CirculationCircuitv2021_v3/R_spleen', 'R', R_spleen);
set_param('CirculationCircuitv2021_v3/R_liver', 'R', R_liver);
set_param('CirculationCircuitv2021_v3/R_svn', 'R', R_svn);
set_param('CirculationCircuitv2021_v3/R_pas', 'R', R_pas);
set_param('CirculationCircuitv2021_v3/R_pat', 'R', R_pat);
set_param('CirculationCircuitv2021_v3/R_par', 'R', R_par);
set_param('CirculationCircuitv2021_v3/R_pcp', 'R', R_pcp);
set_param('CirculationCircuitv2021_v3/R_pvn', 'R', R_pvn);

set_param('CirculationCircuitv2021_v3/C_sas', 'c', C_sas);
set_param('CirculationCircuitv2021_v3/C_sat', 'c', C_sat);
set_param('CirculationCircuitv2021_v3/C_sas', 'c', C_sas);
set_param('CirculationCircuitv2021_v3/C_pas', 'c', C_pas);
set_param('CirculationCircuitv2021_v3/C_pat', 'c', C_pat);
set_param('CirculationCircuitv2021_v3/C_pvn', 'c', C_pvn);

set_param('CirculationCircuitv2021_v3/L_sas', 'l', L_sas);
set_param('CirculationCircuitv2021_v3/L_pas', 'l', L_pas);
set_param('CirculationCircuitv2021_v3/L_sat', 'l', L_sat);
set_param('CirculationCircuitv2021_v3/L_pat', 'l', L_pat);

set_param('CirculationCircuitv2021_v3/Heart_L', 'V1', v1l);
set_param('CirculationCircuitv2021_v3/Heart_L', 'V2', v2l);
set_param('CirculationCircuitv2021_v3/Heart_L', 'TD', tdl);
set_param('CirculationCircuitv2021_v3/Heart_L', 'TF', tfl);
set_param('CirculationCircuitv2021_v3/Heart_L', 'TR', trl);
set_param('CirculationCircuitv2021_v3/Heart_L', 'pW', pwl);
set_param('CirculationCircuitv2021_v3/Heart_L', 'PER', perl);
 
set_param('CirculationCircuitv2021_v3/Heart_R', 'V1', v1r);
set_param('CirculationCircuitv2021_v3/Heart_R', 'V2', v2r);
set_param('CirculationCircuitv2021_v3/Heart_R', 'TD', tdr);
set_param('CirculationCircuitv2021_v3/Heart_R', 'TF', tfr);
set_param('CirculationCircuitv2021_v3/Heart_R', 'TF', trr);
set_param('CirculationCircuitv2021_v3/Heart_R', 'pW', pwr);
set_param('CirculationCircuitv2021_v3/Heart_R', 'PER', perr);

simOut=sim('CirculationCircuitv2021_v3', 'StartTime','0','StopTime',duration,...
            'FixedStep','0.0001'); % Loads and runs model

% Reads in results of Simulink model
Q_right_heart = simOut.Q_right_heart.signals.values;
time = simOut.Q_right_heart.time;
Q_left_heart = simOut.Q_left_heart.signals.values;
V_left_heart = simOut.V_left_heart.signals.values;
V_right_heart = simOut.V_right_heart.signals.values;
P_right_heart = simOut.P_right_heart.signals.values;
P_left_heart = simOut.P_left_heart.signals.values;

Q_sas = simOut.Q_sas.signals.values;
Q_sat = simOut.Q_sat.signals.values;
Q_sar = simOut.Q_sar.signals.values;
Q_scp = simOut.Q_scp.signals.values;
V_sas = simOut.V_sas.signals.values;
V_sat = simOut.V_sat.signals.values;
V_sar = simOut.V_sar.signals.values;
V_scp = simOut.V_scp.signals.values;
P_sas = simOut.P_sas.signals.values;
P_sat = simOut.P_sat.signals.values;
P_sar = simOut.P_sar.signals.values;
P_scp = simOut.P_scp.signals.values;

Q_svn = simOut.Q_svn.signals.values;
V_svn = simOut.V_svn.signals.values;
P_svn = simOut.P_svn.signals.values;

P_organs = simOut.P_organs.signals.values;

Req = 1/((1/str2double(R_liver)) + (1/str2double(R_spleen)) + ...
        (1/str2double(R_kidney)) + (1/str2double(R_brain)));

% V_brain = (V_left_heart + V_right_heart).*0.15;
% V_kidney = (V_left_heart + V_right_heart).*0.25;
% V_spleen = (V_left_heart + V_right_heart).*0.03;
% V_liver = (V_left_heart + V_right_heart).*0.20;
% V_organs = (V_left_heart + V_right_heart);

Q_brain = P_organs ./ str2double(R_brain);
Q_kidney = P_organs ./ str2double(R_kidney);
Q_spleen = P_organs ./ str2double(R_spleen);
Q_liver = P_organs ./ str2double(R_liver);
Q_organs = P_organs ./ Req;

V_brain = mean(Q_brain)*str2double(duration);
V_kidney = mean(Q_kidney)*str2double(duration);
V_spleen = mean(Q_spleen)*str2double(duration);
V_liver = mean(Q_liver)*str2double(duration);
V_organs = mean(Q_organs)*str2double(duration);

Q_pas = simOut.Q_pas.signals.values;
Q_pat = simOut.Q_pat.signals.values;
Q_par = simOut.Q_par.signals.values;
Q_pcp = simOut.Q_pcp.signals.values;
V_pas = simOut.V_pas.signals.values;
V_pat = simOut.V_pat.signals.values;
V_par = simOut.V_par.signals.values;
V_pcp = simOut.V_pcp.signals.values;
P_pas = simOut.P_pas.signals.values;
P_pat = simOut.P_pat.signals.values;
P_par = simOut.P_par.signals.values;
P_pcp = simOut.P_pcp.signals.values;

Q_pvn = simOut.Q_pvn.signals.values;
V_pvn = simOut.V_pvn.signals.values;
P_pvn = simOut.P_pvn.signals.values;

end

function plot_signals(time, Q_right_heart, Q_left_heart, V_left_heart,...
            V_right_heart, P_right_heart, P_left_heart, Q_sas, Q_sat,...
            Q_sar, Q_scp, V_sas, V_sat, V_sar, V_scp, P_sas, P_sat,...
            P_sar, P_scp, Q_svn, V_svn, P_svn, Q_organs, V_organs,...
            P_organs, Q_brain, Q_kidney, Q_spleen, Q_liver, V_brain,...
            V_kidney, V_spleen, V_liver, Q_pas, Q_pat, Q_par, Q_pcp,...
            V_pas, V_pat, V_par, V_pcp, P_pas, P_pat, P_par, P_pcp,...
            Q_pvn, V_pvn, P_pvn)
% This function plots all of the pressure, flow, and volume results from
% the Simulink model.

% REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH
% Heart Dynamics
% REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH
figure
subplot(2,3,1)
plot(time,Q_right_heart);
title('Q_{Right Heart}');
xlabel('Time (s)');
ylabel('Flow Rate (mL/s)');

subplot(2,3,4)
plot(time,Q_left_heart);
title('Q_{Left Heart}');
xlabel('Time (s)');
ylabel('Flow Rate (mL/s)');

subplot(2,3,2)
plot(time,V_right_heart);
title('V_{Right Heart}');
xlabel('Time (s)');
ylabel('Blood Volume (mL)');

subplot(2,3,5)
plot(time,V_left_heart);
title('V_{Left Heart}');
xlabel('Time (s)');
ylabel('Blood Volume (mL)');

subplot(2,3,6)
plot(time,P_left_heart);
title('P_{Left Heart}');
xlabel('Time (s)');
ylabel('Blood Pressure (mmHg)');

subplot(2,3,3)
plot(time,P_right_heart);
title('P_{Right Heart}');
xlabel('Time (s)');
ylabel('Blood Pressure (mmHg)');

sgtitle('Heart Blood Flow Dynamics');
% set(gcf, 'Units', 'Normalized', 'OuterPosition', [0 0 1 1]);
saveas(gcf, 'Heart Blood Flow Dynamics.png');


% REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH
% Systemic Arterial Loop Dynamics
% REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH
figure
subplot(4,3,1)
plot(time, Q_sas);
title('Q_{sas}');
xlabel('Time (s)');
ylabel('Flow Rate (mL/s)');

subplot(4,3,4)
plot(time, Q_sat);
title('Q_{sat}');
xlabel('Time (s)');
ylabel('Flow Rate (mL/s)');

subplot(4,3,7)
plot(time, Q_sar);
title('Q_{sar}');
xlabel('Time (s)');
ylabel('Flow Rate (mL/s)');

subplot(4,3,10)
plot(time, Q_scp);
title('Q_{scp}');
xlabel('Time (s)');
ylabel('Flow Blood VolumeRate (mL/s)');

subplot(4,3,2)
plot(time, V_sas);
title('V_{sas}');
xlabel('Time (s)');
ylabel('Blood Volume (mL)');

subplot(4,3,5)
plot(time, V_sat);
title('V_{sat}');
xlabel('Time (s)');
ylabel('Blood Volume (mL)');

subplot(4,3,8)
plot(time, V_sar);
title('V_{sar}');
xlabel('Time (s)');
ylabel('Blood Volume (mL)');

subplot(4,3,11)
plot(time, V_scp);
title('V_{scp}');
xlabel('Time (s)');
ylabel('Blood Volume (mL)');

subplot(4,3,3)
plot(time,P_sas);
title('P_{sas}');
xlabel('Time (s)');
ylabel('Blood Pressure (mmHg)');

subplot(4,3,6)
plot(time,P_sat);
title('P_{sat}');
xlabel('Time (s)');
ylabel('Blood Pressure (mmHg)');

subplot(4,3,9)
plot(time,P_sar);
title('P_{sar}');
xlabel('Time (s)');
ylabel('Blood Pressure (mmHg)');

subplot(4,3,12)
plot(time,P_scp);
title('P_{scp}');
xlabel('Time (s)');
ylabel('Blood Pressure (mmHg)');

sgtitle('Systemic Circuit Arterial Blood Flow Dynamics');
% set(gcf, 'Units', 'Normalized', 'OuterPosition', [0 0 1 1]);

saveas(gcf, 'Systemic Circuit Arterial Blood Flow Dynamics.png');

% REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH
% Systemic Venous Loop Dynamics
% REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH

figure
subplot(3,1,1)
plot(time, Q_svn);
title('Q_{svn}');
xlabel('Time (s)');
ylabel('Flow Rate (mL/s)');

subplot(3,1,2)
plot(time, V_svn);
title('V_{svn}');
xlabel('Time (s)');
ylabel('Blood Volume (mL)');

subplot(3,1,3)
plot(time, P_svn);
title('P_{svn}');
xlabel('Time (s)');
ylabel('Blood Pressure (mmHg)');

sgtitle("Systemic Circuit Venous Blood Flow Dynamics");
% set(gcf, 'Units', 'Normalized', 'OuterPosition', [0 0 1 1]);
saveas(gcf, "Systemic Circuit Venous Blood Flow Dynamics.png");

% REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH
% Organ Dynamics
% REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH

figure
subplot(2,1,1)
plot(time,Q_organs);
title('Q_o');
xlabel('Time (s)');
ylabel('Flow Rate (mL/s)');

subplot(2,1,2)
plot(time, P_organs);
title('P_{o}');
xlabel('Time (s)');
ylabel('Blood Pressure (mmHg)');

sgtitle("Total Organ Blood Flow Dynamics");
% set(gcf, 'Units', 'Normalized', 'OuterPosition', [0 0 1 1]);
saveas(gcf, "Total Organ Blood Flow Dynamics.png");

figure
subplot(2,2,1)
plot(time, Q_brain);
title('Q_{brain}');
xlabel('Time (s)');
ylabel('Flow Rate (mL/s)');

subplot(2,2,2)
plot(time, Q_kidney);
title('Q_{kidney}');
xlabel('Time (s)');
ylabel('Flow Rate (mL/s)');

subplot(2,2,3)
plot(time, Q_liver);
title('Q_{liver}');
xlabel('Time (s)');
ylabel('Flow Rate (mL/s)');

subplot(2,2,4)
plot(time, Q_spleen);
title('Q_{slpeen}');
xlabel('Time (s)');
ylabel('Flow Rate (mL/s)');

sgtitle("Specific Organ Blood Flow Dynamics");
% set(gcf, 'Units', 'Normalized', 'OuterPosition', [0 0 1 1]);
saveas(gcf, "Specific Organ Blood Flow Dynamics.png");

% REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH
% Pulmonary Circuit Arterial Dynamics
% REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH

figure
subplot(4,3,1)
plot(time, Q_pas);
title('Q_{pas}');
xlabel('Time (s)');
ylabel('Flow Rate (mL/s)');

subplot(4,3,2)
plot(time, V_pas);
title('V_{pas}');
xlabel('Time (s)');
ylabel('Blood Volume (mL)');

subplot(4,3,3)
plot(time, P_pas);
title('P_{pas}');
xlabel('Time (s)');
ylabel('Blood Pressure (mmHg)');

subplot(4,3,4)
plot(time, Q_pat);
title('Q_{pat}');
xlabel('Time (s)');
ylabel('Flow Rate (mL/s)');

subplot(4,3,5)
plot(time, V_pat);
title('V_{pat}');
xlabel('Time (s)');
ylabel('Blood Volume (mL)');

subplot(4,3,6)
plot(time, P_pat);
title('P_{pat}');
xlabel('Time (s)');
ylabel('Blood Pressure (mmHg)');

subplot(4,3,7)
plot(time, Q_par);
title('Q_{par}');
xlabel('Time (s)');
ylabel('Flow Rate (mL/s)');

subplot(4,3,8)
plot(time, V_par);
title('V_{par}');
xlabel('Time (s)');
ylabel('Blood Volume (mL)');

subplot(4,3,9)
plot(time, P_par);
title('P_{par}');
xlabel('Time (s)');
ylabel('Blood Pressure (mmHg)');

subplot(4,3,10)
plot(time, Q_pcp);
title('Q_{pcp}');
xlabel('Time (s)');
ylabel('Flow Rate (mL/s)');

subplot(4,3,11)
plot(time, V_pcp);
title('V_{pcp}');
xlabel('Time (s)');
ylabel('Blood Volume (mL)');

subplot(4,3,12)
plot(time, P_pcp);
title('P_{pcp}');
xlabel('Time (s)');
ylabel('Blood Pressure (mmHg)');

sgtitle('Pulmonary Circuit Arterial Blood Flow Dynamics');
% set(gcf, 'Units', 'Normalized', 'OuterPosition', [0 0 1 1]);
saveas(gcf, 'Pulmonary Circuit Arterial Blood Flow Dynamics.png');

% REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH
% Pulmonary Circuit Venous Dynamics
% REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH

figure
subplot(3,1,1)
plot(time, Q_pvn);
title('Q_{pvn}');
xlabel('Time (s)');
ylabel('Flow Rate (mL/s)');

subplot(3,1,2)
plot(time, V_pvn);
title('V_{pvn}');
xlabel('Time (s)');
ylabel('Blood Volume (mL)');

subplot(3,1,3)
plot(time, P_pvn);
title('P_{pvn}');
xlabel('Time (s)');
ylabel('Blood Pressure (mmHg)');

sgtitle("Pulmonary Circuit Venous Blood Flow Dynamics");
% set(gcf, 'Units', 'Normalized', 'OuterPosition', [0 0 1 1]);
saveas(gcf, "Pulmonary Circuit Venous Blood Flow Dynamics.png");

end


##### SOURCE END #####
--></body></html>